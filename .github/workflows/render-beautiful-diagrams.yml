name: Render Tropical Mermaid Diagrams

on:
  push:
    paths:
      - 'docs/infra/**/*.mmd'
  workflow_dispatch:

jobs:
  render:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Check out repo
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ Install Node and Mermaid CLI (v10.9.1 supports --themeFile)
      - name: Install Mermaid CLI
        run: |
          npm install -g @mermaid-js/mermaid-cli@10.9.1
          mmdc --version

      # 3Ô∏è‚É£ Make sure output folder exists
      - name: Create output folder
        run: mkdir -p docs/infra/out

      # 4Ô∏è‚É£ Render each .mmd file to .svg with your tropical theme
     - name: Render diagrams
        run: |
      echo "Rendering Mermaid diagrams..."
      for f in docs/infra/*.mmd; do
      base=$(basename "$f" .mmd)
      echo "üñºÔ∏è  Rendering $f ‚Üí docs/infra/out/${base}.svg"
      mmdc -i "$f" \
           -o "docs/infra/out/${base}.svg" \
           -t default \
           -b transparent \
           -w 1600 -H 1000 \
           --scale 2
    done
    echo "‚úÖ All diagrams rendered!"


      # 5Ô∏è‚É£ Commit changes back to repo (optional if you want automation)
      - name: Commit updated SVGs
        run: |
          git config --global user.name "Mermaid Bot"
          git config --global user.email "bot@digitalmonsters.com"
          git add docs/infra/out/*.svg || true
          git diff --cached --quiet && echo "No SVG ch
